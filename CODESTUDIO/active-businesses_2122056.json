{
    "status": 200,
    "message": "Question Data fetched successfully",
    "data": {
        "question": {
            "questionFrontendId": 14407,
            "title": "Active Businesses",
            "titleSlug": "active-businesses_2122056",
            "content": "<h4 id=\"table-events\">Table: <b>Events</b></h4>\n\n<pre><code>+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| business_id   | int     |\n| event_type    | varchar |\n| occurences    | int     | \n+---------------+---------+\n</code></pre>\n\n<ul>\n<li>(business<em>id, event</em>type) is the primary key of this table.</li>\n<li>Each row in the table logs the info that an event of some type occurred at some business for a number of times.\n<br></li>\n</ul>\n\n<h4 id=\"the-average-activity-for-a-particular-event_type-is-the-average-occurences-across-all-companies-that-have-this-event\">The average activity for a particular event_type is the average occurences across all companies that have this event.</h4>\n\n<p><br></p>\n\n<h4 id=\"an-active-business-is-a-business-that-has-more-than-one-event_type-such-that-their-occurences-is-strictly-greater-than-the-average-activity-for-that-event\">An active business is a business that has more than one event_type such that their occurences is strictly greater than the average activity for that event.</h4>\n\n<p><br></p>\n\n<h4 id=\"write-an-sql-query-to-find-all-active-businesses\">Write an SQL query to find all active businesses.</h4>\n\n<p><br></p>\n\n<h4 id=\"the-query-result-format-is-in-the-following-example-events-table\">The query result format is in the following example: <b>Events table:</b></h4>\n\n<pre><code>+-------------+------------+------------+\n| business_id | event_type | occurences |\n+-------------+------------+------------+\n| 1           | reviews          |  7          |\n| 3           | reviews          |  3          |\n| 1           | ads                 | 11         |\n| 2           | ads                 |  7          |\n| 3           | ads                 |  6          |\n| 1           | page views    |  3          |\n| 2           | page views    |  12        |\n+-------------+------------+------------+\n</code></pre>\n\n<h4 id=\"result-table\"><b>Result table:</b></h4>\n\n<pre><code>+-------------+\n| business_id |\n+-------------+\n| 1           |\n+-------------+ \n</code></pre>\n\n<p><br></p>\n\n<h5 id=\"explanation\">Explanation:</h5>\n\n<p><br></p>\n\n<ul>\n<li>The average activity for each event can be calculated as follows:\n\n<ul>\n<li>&#39;reviews&#39;: (7+3)/2 = 5</li>\n<li>&#39;ads&#39;: (11+7+6)/3 = 8</li>\n<li>&#39;page views&#39;: (3+12)/2 = 7.5\nThe business with id=1 has 7 &#39;reviews&#39; events (more than 5) and 11 &#39;ads&#39; events (more than 8), so it is an active business.</li>\n</ul></li>\n</ul>\n",
            "isPaidOnly": false,
            "difficulty": "Hard",
            "likes": -9,
            "dislikes": "NA",
            "rephrased": {
                "body": "Given a table `Events` containing information about events occurring at different businesses, identify and return all active businesses. An active business is defined as one that has more than one event type where its occurrences are strictly greater than the average occurrences for that specific event type across all businesses.",
                "constraints": [
                    "(business_id, event_type) is the primary key of the Events table."
                ],
                "testcases": [
                    {
                        "input": "Table: Events\n+-------------+------------+------------+\n| business_id | event_type | occurences |\n+-------------+------------+------------+\n| 1           | reviews    | 7          |\n| 3           | reviews    | 3          |\n| 1           | ads        | 11         |\n| 2           | ads        | 7          |\n| 3           | ads        | 6          |\n| 1           | page views | 3          |\n| 2           | page views | 12         |\n+-------------+------------+------------+",
                        "output": "Table: Result\n+-------------+\n| business_id |\n+-------------+\n| 1           |\n+-------------+",
                        "explanation": "The average activity for each event type is:\n- 'reviews': (7+3)/2 = 5\n- 'ads': (11+7+6)/3 = 8\n- 'page views': (3+12)/2 = 7.5\nBusiness 1 has 7 'reviews' (more than 5) and 11 'ads' (more than 8). Therefore, it is an active business."
                    }
                ]
            }
        },
        "similar": [],
        "hints": [],
        "relatedTopics": [
            {
                "name": "SQL",
                "slug": "sql"
            }
        ],
        "solutions": [],
        "platform": "CODESTUDIO"
    }
}