{
    "status": 200,
    "message": "Question Data fetched successfully",
    "data": {
        "question": {
            "questionFrontendId": 14370,
            "title": "Number of Comments per Post",
            "titleSlug": "number-of-comments-per-post_2117115",
            "content": "<pre><code>Table: Submissions\n\n+---------------+----------+\n| Column Name   | Type     |\n+---------------+----------+\n| sub_id        | int      |\n| parent_id     | int      |\n+---------------+----------+\nThere is no primary key for this table, it may have duplicate rows.\nEach row can be a post or comment on the post.\nparent_id is null for posts.\nparent_id for comments is sub_id for another post in the table.\n\n\nWrite an SQL query to find number of comments per each post.\n\nResult table should contain post_id and its corresponding number_of_comments, and must be sorted by post_id in ascending order.\n\nSubmissions may contain duplicate comments. You should count the number of unique comments per post.\n\nSubmissions may contain duplicate posts. You should treat them as one post.\n\nThe query result format is in the following example:\n\nSubmissions table:\n+---------+------------+\n| sub_id  | parent_id  |\n+---------+------------+\n| 1       | Null       |\n| 2       | Null       |\n| 1       | Null       |\n| 12      | Null       |\n| 3       | 1          |\n| 5       | 2          |\n| 3       | 1          |\n| 4       | 1          |\n| 9       | 1          |\n| 10      | 2          |\n| 6       | 7          |\n+---------+------------+\n\n Result table:\n+---------+--------------------+\n| post_id | number_of_comments |\n+---------+--------------------+\n| 1       | 3                  |\n| 2       | 2                  |\n| 12      | 0                  |\n+---------+--------------------+\n\nThe post with id 1 has three comments in the table with id 3, 4 and 9. The comment with id 3 is repeated in the table, we counted it only once.\nThe post with id 2 has two comments in the table with id 5 and 10.\nThe post with id 12 has no comments in the table.\nThe comment with id 6 is a comment on a deleted post with id 7 so we ignored it.\n</code></pre>\n",
            "isPaidOnly": false,
            "difficulty": "Medium",
            "likes": 3,
            "dislikes": "NA",
            "rephrased": {
                "body": "Write an SQL query to find the number of comments for each post in the `Submissions` table. The result table should contain `post_id` and its corresponding `number_of_comments`, sorted by `post_id` in ascending order. Duplicate comments for a single post should only be counted once. Treat duplicate posts as a single post. Ignore comments referencing non-existent posts.",
                "constraints": [],
                "testcases": [
                    {
                        "input": "Submissions table:\n+---------+------------+\n| sub_id  | parent_id  |\n+---------+------------+\n| 1       | Null       |\n| 2       | Null       |\n| 1       | Null       |\n| 12      | Null       |\n| 3       | 1          |\n| 5       | 2          |\n| 3       | 1          |\n| 4       | 1          |\n| 9       | 1          |\n| 10      | 2          |\n| 6       | 7          |\n+---------+------------+",
                        "output": "+---------+--------------------+\n| post_id | number_of_comments |\n+---------+--------------------+\n| 1       | 3                  |\n| 2       | 2                  |\n| 12      | 0                  |\n+---------+--------------------+",
                        "explanation": "Post 1 has comments 3, 4, and 9.  Comment 3 appears twice, but is only counted once. Post 2 has comments 5 and 10. Post 12 has no comments. Comment 6 referencing non-existent post 7 is ignored."
                    }
                ]
            }
        },
        "similar": [],
        "hints": [],
        "relatedTopics": [
            {
                "name": "SQL",
                "slug": "sql"
            }
        ],
        "solutions": {},
        "platform": "CODESTUDIO"
    }
}