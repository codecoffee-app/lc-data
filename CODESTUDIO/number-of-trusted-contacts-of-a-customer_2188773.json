{
    "status": 200,
    "message": "Question Data fetched successfully",
    "data": {
        "question": {
            "questionFrontendId": 14525,
            "title": "Number of Trusted Contacts of a Customer",
            "titleSlug": "number-of-trusted-contacts-of-a-customer_2188773",
            "content": "<pre><code>Table: Customers\n\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| customer_id   | int     |\n| customer_name | varchar |\n| email         | varchar |\n+---------------+---------+\ncustomer_id is the primary key for this table.\nEach row of this table contains the name and the email of a customer of an online shop.\n\n\nTable: Contacts\n\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| user_id       | id      |\n| contact_name  | varchar |\n| contact_email | varchar |\n+---------------+---------+\n(user_id, contact_email) is the primary key for this table.\nEach row of this table contains the name and email of one contact of customer with user_id.\nThis table contains information about people each customer trust. The contact may or may not exist in the Customers table.\n\n\n\nTable: Invoices\n\n+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| invoice_id   | int     |\n| price        | int     |\n| user_id      | int     |\n+--------------+---------+\ninvoice_id is the primary key for this table.\nEach row of this table indicates that user_id has an invoice with invoice_id and a price.\n\n\nWrite an SQL query to find the following for each invoice_id:\n\ncustomer_name: The name of the customer the invoice is related to.\nprice: The price of the invoice.\ncontacts_cnt: The number of contacts related to the customer.\ntrusted_contacts_cnt: The number of contacts related to the customer and at the same time they are customers to the shop. (i.e His/Her email exists in the Customers table.)\nOrder the result table by invoice_id.\n\nThe query result format is in the following example:\n\nCustomers table:\n+-------------+---------------+--------------------+\n| customer_id | customer_name | email              |\n+-------------+---------------+--------------------+\n| 1           | Alice         | alice@codingninjas.com |\n| 2           | Bob           | bob@codingninjas.com   |\n| 13          | John          | john@codingninjas.com  |\n| 6           | Alex          | alex@codingninjas.com  |\n+-------------+---------------+--------------------+\nContacts table:\n+-------------+--------------+--------------------+\n| user_id     | contact_name | contact_email      |\n+-------------+--------------+--------------------+\n| 1           | Bob          | bob@codingninjas.com   |\n| 1           | John         | john@codingninjas.com  |\n| 1           | Jal          | jal@codingninjas.com   |\n| 2           | Omar         | omar@codingninjas.com  |\n| 2           | Meir         | meir@codingninjas.com  |\n| 6           | Alice        | alice@codingninjas.com |\n+-------------+--------------+--------------------+\nInvoices table:\n+------------+-------+---------+\n| invoice_id | price | user_id |\n+------------+-------+---------+\n| 77         | 100   | 1       |\n| 88         | 200   | 1       |\n| 99         | 300   | 2       |\n| 66         | 400   | 2       |\n| 55         | 500   | 13      |\n| 44         | 60    | 6       |\n+------------+-------+---------+\nResult table:\n+------------+---------------+-------+--------------+----------------------+\n| invoice_id | customer_name | price | contacts_cnt | trusted_contacts_cnt |\n+------------+---------------+-------+--------------+----------------------+\n| 44         | Alex          | 60    | 1            | 1                    |\n| 55         | John          | 500   | 0            | 0                    |\n| 66         | Bob           | 400   | 2            | 0                    |\n| 77         | Alice         | 100   | 3            | 2                    |\n| 88         | Alice         | 200   | 3            | 2                    |\n| 99         | Bob           | 300   | 2            | 0                    |\n+------------+---------------+-------+--------------+----------------------+\nAlice has three contacts, two of them are trusted contacts (Bob and John).\nBob has two contacts, none of them is a trusted contact.\nAlex has one contact and it is a trusted contact (Alice).\nJohn doesn&#39;t have any contacts.\n</code></pre>\n",
            "isPaidOnly": false,
            "difficulty": "Hard",
            "likes": -7,
            "dislikes": "NA",
            "rephrased": {
                "body": "Given three tables: `Customers`, `Contacts`, and `Invoices`, write an SQL query to find the following for each `invoice_id`:\n\n*   `customer_name`: The name of the customer associated with the invoice.\n*   `price`: The price of the invoice.\n*   `contacts_cnt`: The total number of contacts for the customer.\n*   `trusted_contacts_cnt`: The number of contacts who are also customers (i.e., their email exists in the `Customers` table).\n\nOrder the result table by `invoice_id`.",
                "constraints": [],
                "testcases": [
                    {
                        "input": "Customers table:\n+-------------+---------------+--------------------+\n| customer_id | customer_name | email              |\n+-------------+---------------+--------------------+\n| 1           | Alice         | alice@codingninjas.com |\n| 2           | Bob           | bob@codingninjas.com   |\n| 13          | John          | john@codingninjas.com  |\n| 6           | Alex          | alex@codingninjas.com  |\n+-------------+---------------+--------------------+\nContacts table:\n+-------------+--------------+--------------------+\n| user_id     | contact_name | contact_email      |\n+-------------+--------------+--------------------+\n| 1           | Bob          | bob@codingninjas.com   |\n| 1           | John         | john@codingninjas.com  |\n| 1           | Jal          | jal@codingninjas.com   |\n| 2           | Omar         | omar@codingninjas.com  |\n| 2           | Meir         | meir@codingninjas.com  |\n| 6           | Alice        | alice@codingninjas.com |\n+-------------+--------------+--------------------+\nInvoices table:\n+------------+-------+---------+\n| invoice_id | price | user_id |\n+------------+-------+---------+\n| 77         | 100   | 1       |\n| 88         | 200   | 1       |\n| 99         | 300   | 2       |\n| 66         | 400   | 2       |\n| 55         | 500   | 13      |\n| 44         | 60    | 6       |\n+------------+-------+---------+",
                        "output": "+------------+---------------+-------+--------------+----------------------+\n| invoice_id | customer_name | price | contacts_cnt | trusted_contacts_cnt |\n+------------+---------------+-------+--------------+----------------------+\n| 44         | Alex          | 60    | 1            | 1                    |\n| 55         | John          | 500   | 0            | 0                    |\n| 66         | Bob           | 400   | 2            | 0                    |\n| 77         | Alice         | 100   | 3            | 2                    |\n| 88         | Alice         | 200   | 3            | 2                    |\n| 99         | Bob           | 300   | 2            | 0                    |\n+------------+---------------+-------+--------------+----------------------+",
                        "explanation": "For invoice_id 44, customer is Alex who has 1 contact(Alice), and Alice is a trusted contact (customer).\nFor invoice_id 55, customer is John who has 0 contact, so 0 trusted contact as well.\nFor invoice_id 66, customer is Bob who has 2 contacts (Omar, Meir), none of them are trusted contacts (customers).\nFor invoice_id 77, customer is Alice who has 3 contacts(Bob, John, Jal), Bob and John are trusted contacts (customers).\nFor invoice_id 88, customer is Alice who has 3 contacts(Bob, John, Jal), Bob and John are trusted contacts (customers).\nFor invoice_id 99, customer is Bob who has 2 contacts (Omar, Meir), none of them are trusted contacts (customers)."
                    },
                    {
                        "input": null,
                        "output": null,
                        "explanation": "if not present then null"
                    }
                ]
            }
        },
        "similar": [],
        "hints": [],
        "relatedTopics": [
            {
                "name": "SQL",
                "slug": "sql"
            }
        ],
        "solutions": [],
        "platform": "CODESTUDIO"
    }
}